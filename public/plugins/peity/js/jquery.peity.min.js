!function(t,i,e,n){var a=t.fn.peity=function(i,e){return l&&this.each(function(){var n=t(this),h=n.data("_peity");h?(i&&(h.type=i),t.extend(h.opts,e)):(h=new r(n,i,t.extend({},a.defaults[i],n.data("peity"),e)),n.change(function(){h.draw()}).data("_peity",h)),h.draw()}),this},r=function(t,i,e){this.$el=t,this.type=i,this.opts=e},h=r.prototype,s=h.svgElement=function(e,n){return t(i.createElementNS("http://www.w3.org/2000/svg",e)).attr(n)},l="createElementNS"in i&&s("svg",{})[0].createSVGRect;h.draw=function(){var t=this.opts;a.graphers[this.type].call(this,t),t.after&&t.after.call(this,t)},h.fill=function(){var i=this.opts.fill;return t.isFunction(i)?i:function(t,e){return i[e%i.length]}},h.prepare=function(t,i){return this.$svg||this.$el.hide().after(this.$svg=s("svg",{class:"peity"})),this.$svg.empty().data("_peity",this).attr({height:i,width:t})},h.values=function(){return t.map(this.$el.text().split(this.opts.delimiter),function(t){return parseFloat(t)})},a.defaults={},a.graphers={},a.register=function(t,i,e){this.defaults[t]=i,this.graphers[t]=e},a.register("pie",{fill:["#ff9900","#fff5e6","#f44034","#4cae4f","#2094f3","#673ab6","#3db9db"],radius:8},function(i){if(!i.delimiter){var n=this.$el.text().match(/[^0-9\.]/);i.delimiter=n?n[0]:","}var a=t.map(this.values(),function(t){return t>0?t:0});if("/"==i.delimiter){var r=a[0],h=a[1];a=[r,e.max(0,h-r)]}for(var l=0,o=a.length,p=0;l<o;l++)p+=a[l];p||(o=2,p=1,a=[0,1]);var f=2*i.radius,u=this.prepare(i.width||f,i.height||f),c=u.width()/2,d=u.height()/2,g=e.min(c,d),v=i.innerRadius;"donut"!=this.type||v||(v=.5*g);var m=e.PI,y=this.fill(),w=this.scale=function(t,i){var n=t/p*m*2-m/2;return[i*e.cos(n)+c,i*e.sin(n)+d]},x=0;for(l=0;l<o;l++){var k,$=a[l],j=$/p;if(0!=j){if(1==j)if(v){var b=c-.01,A=d-g,E=d-v;k=s("path",{d:["M",c,A,"A",g,g,0,1,1,b,A,"L",b,E,"A",v,v,0,1,0,c,E].join(" "),"data-value":$})}else k=s("circle",{cx:c,cy:d,"data-value":$,r:g});else{var M=x+$,S=["M"].concat(w(x,g),"A",g,g,0,j>.5?1:0,1,w(M,g),"L");v?S=S.concat(w(M,v),"A",v,v,0,j>.5?1:0,0,w(x,v)):S.push(c,d),x+=$,k=s("path",{d:S.join(" "),"data-value":$})}k.attr("fill",y.call(this,$,l,a)),u.append(k)}}}),a.register("donut",t.extend(!0,{},a.defaults.pie),function(t){a.graphers.pie.call(this,t)}),a.register("line",{delimiter:",",fill:"#f0f8fe",height:16,min:0,stroke:"#2094f3",strokeWidth:1,width:32},function(t){var i=this.values();1==i.length&&i.push(i[0]);for(var n=e.max.apply(e,void 0==t.max?i:i.concat(t.max)),a=e.min.apply(e,void 0==t.min?i:i.concat(t.min)),r=this.prepare(t.width,t.height),h=t.strokeWidth,l=r.width(),o=r.height()-h,p=n-a,f=this.x=function(t){return t*(l/(i.length-1))},u=this.y=function(t){var i=o;return p&&(i-=(t-a)/p*o),i+h/2},c=u(e.max(a,0)),d=[0,c],g=0;g<i.length;g++)d.push(f(g),u(i[g]));d.push(l,c),t.fill&&r.append(s("polygon",{fill:t.fill,points:d.join(" ")})),h&&r.append(s("polyline",{fill:"none",points:d.slice(2,d.length-2).join(" "),stroke:t.stroke,"stroke-width":h,"stroke-linecap":"square"}))}),a.register("bar",{delimiter:",",fill:["#2094f3"],height:16,min:0,padding:.1,width:32},function(t){for(var i=this.values(),n=e.max.apply(e,void 0==t.max?i:i.concat(t.max)),a=e.min.apply(e,void 0==t.min?i:i.concat(t.min)),r=this.prepare(t.width,t.height),h=r.width(),l=r.height(),o=n-a,p=t.padding,f=this.fill(),u=this.x=function(t){return t*h/i.length},c=this.y=function(t){return l-(o?(t-a)/o*l:1)},d=0;d<i.length;d++){var g,v=u(d+p),m=u(d+1-p)-v,y=i[d],w=c(y),x=w,k=w;o?y<0?x=c(e.min(n,0)):k=c(e.max(a,0)):g=1,0==(g=k-x)&&(g=1,n>0&&o&&x--),r.append(s("rect",{"data-value":y,fill:f.call(this,y,d,i),x:v,y:x,width:m,height:g}))}})}(jQuery,document,Math);